function cellCreateImage(t,i,r){$.each(t,function(t,a){if(null!=a.value){var e=$('<div class="cell-img"></div>');e[0].style.backgroundImage='url("'+a.value+'")',e[0].style.backgroundRepeat="no-repeat",e.css({position:"absolute",left:a.left+"px",top:a.top+"px",width:a.width+"px",height:a.height+"px","z-index":101}),e.attr("data-index",t),e.data("r",i),e.data("c",r),e[0].style.backgroundSize=a.width+"px "+a.height+"px",$(".ht_master .wtHider").append(e),e.myDrag({randomPosition:!1,direction:"all",handler:!1,x:a.left+"px",y:a.top+"px",elem:$(".ht_master .wtHider"),dragEnd:function(t,a,e){if(0<=t.data("r")&&0<=t.data("c")){var i=hot.Methods.getCellMeta(t.data("r"),t.data("c")).image[t.data("index")];i.top=e,i.left=a}}}),e.dragDivResize($(".ht_master .wtHider")[0],function(t,a,e){var i=hot.Methods.getCellMeta(t.data("r"),t.data("c")).image[t.data("index")];i.width=a,i.height=e}),e.bind("click",function(){return $(".cell-img").removeClass("curr-img"),$(this).addClass("curr-img"),!1})}})}$(function(){var e,i=window.URL||window.webkitURL,r=$("#image"),a=$("#dataX"),d=$("#dataY"),o=$(".rdp-cropper"),l=$("#dataHeight"),n=$("#dataWidth"),c=$("#dataWidthRatio"),s=$("#dataHeightRatio"),h=$("#dataRotate"),p=$("#dataScaleX"),u=$("#dataScaleY"),t=$("#save-cropper-image"),g=$("#cancel-cropper-image"),m=!1,v={aspectRatio:16/9,preview:".rdp-img-preview",crop:function(t){m||(a.val(Math.round(t.detail.x)),d.val(Math.round(t.detail.y)),l.val(Math.round(t.detail.height)),n.val(Math.round(t.detail.width)),s.val(Math.round(t.detail.height)),c.val(Math.round(t.detail.width)),h.val(t.detail.rotate),p.val(t.detail.scaleX),u.val(t.detail.scaleY))}};r.attr("src");r.on({ready:function(t){},cropstart:function(t){},cropmove:function(t){},cropend:function(t){},crop:function(t){},zoom:function(t){}}).cropper(v),$(".rdp-img-menu .menu-item").bind("click",function(){var t=$(this).data();if(r.data("cropper")&&t.method)switch(t=$.extend({},t),result=r.cropper(t.method,t.option,t.secondOption),t.method){case"scaleX":case"scaleY":$(this).data("option",-t.option)}}),$(".docs-toggles").on("change","input",function(){var t=$(this),a=t.attr("name");"radio"===t.prop("type")&&(v[a]=t.val(),t.parents("li").addClass("active").siblings().removeClass("active")),r.cropper("destroy").cropper(v)}),$(".docs-data .cropper-data").bind("input propertychange",function(){m=!0;var t={};t.x=Number(a.val()),t.y=Number(d.val()),t.height=Number(l.val()),t.width=Number(n.val()),t.rotate=Number(h.val()),t.scaleX=Number(p.val()),t.scaleY=Number(u.val()),m=!1,r.cropper("setData",t),t=null}),$(".docs-data .cropper-ratio").bind("input propertychange",function(){var t=$('input[name="aspectRatio"]:checked').val();if("NaN"!=t){var a=Number(this.value);if("dataWidthRatio"==this.id){var e=a/t;s.val(Math.round(e))}else if("dataHeightRatio"==this.id){e=a*t;c.val(Math.round(e))}}}),t.bind("click",function(){var t={};if(t.width=c.val(),t.height=s.val(),t.fillColor="#fff",result=r.cropper("getCroppedCanvas",t),"importImage"==imageActionName){var a=hot.Methods.getSelected();if(a){var e=a[0],i=hot.Methods.getCell(e[0],e[1]);hot.Methods.setCellMeta(e[0],e[1],"bgimage",result.toDataURL()),i.style.backgroundImage='url("'+result.toDataURL()+'")',i.style.backgroundRepeat="no-repeat"}}else if("addImage"==imageActionName){var l=$('<div class="cell-img"></div>');l[0].style.backgroundImage='url("'+result.toDataURL()+'")',l[0].style.backgroundRepeat="no-repeat",l.css({position:"absolute",left:"49px",top:"25px","z-index":101});var n=new Image;n.onload=function(){var t=n.width,a=n.height;l.css({width:t+"px",height:a+"px"}),l[0].style.backgroundSize=t+"px "+a+"px",$(".ht_master .wtHider").append(l),l.myDrag({randomPosition:!1,direction:"all",handler:!1,elem:$(".ht_master .wtHider"),dragEnd:function(t,a,e){if(0<=t.data("r")&&0<=t.data("c")){var i=hot.Methods.getCellMeta(t.data("r"),t.data("c")).image[t.data("index")];i.top=e,i.left=a}}}),l.dragDivResize($(".ht_master .wtHider")[0],function(t,a,e){var i=hot.Methods.getCellMeta(t.data("r"),t.data("c")).image[t.data("index")];i.width=a,i.height=e});var e=hot.Methods.getSelected();if(e){var i=e[0],r=hot.Methods.getCellMeta(i[0],i[1]).image||[],d={};d.value=result.toDataURL(),d.width=t,d.height=a,d.top=0,d.left=0,r.push(d);var o=r.length-1;l.data("r",i[0]),l.data("c",i[1]),l.data("index",o),hot.Methods.setCellMeta(i[0],i[1],"image",r)}l.bind("click",function(){return $(".cell-img").removeClass("curr-img"),$(this).addClass("curr-img"),!1})},n.src=result.toDataURL()}o.hide()}),g.bind("click",function(){o.hide()});var f=$("#importImage");i?f.bind("change",function(){o.css({"z-index":104,opacity:1}).show();var t,a=this.files;r.data("cropper")&&a&&a.length&&(t=a[0],/^image\/\w+$/.test(t.type)?(t.name,t.type,e&&i.revokeObjectURL(e),e=i.createObjectURL(t),r.cropper("destroy").attr("src",e).cropper(v),f.val(""),setTimeout(function(){c.val(n.val()),s.val(l.val())},100)):window.alert("Please choose an image file."))}):f.prop("disabled",!0).parent().addClass("disabled"),$(document).bind("click",function(){$(".cell-img").removeClass("curr-img")})});