var globalData;function getgGlobalData(a){$.getJSON(a,function(a){globalData=a})}function createTagsBox(a,e,t){switch(a.type){case"line":bulidLineChart(a,e,t);break;case"bar":bulidBarChart(a,e,t);break;case"pie":bulidPieChart(a,e,t);break;case"radar":bulidRadarChart(a,e,t);break;case"tree":bulidTreeChart(a,e,t);break;case"treemap":bulidTreemapChart(a,e,t);break;case"sunburst":bulidSunburstChart(a,e,t);break;case"funnel":bulidFunnelChart(a,e,t);break;case"gauge":bulidGaugeChart(a,e,t);break;case"boxplot":bulidBoxplotChart(a,e,t);break;case"heatmap":bulidHeatmapChart(a,e,t);break;case"graph":bulidGraphChart(a,e,t);break;case"parallel":bulidParallelChart(a,e,t);break;case"sankey":bulidsankeyChart(a,e,t);break;case"scatter":bulidScatterChart(a,e,t);break;case"map":bulidMapChart(a,e,t);break;case"candlestick":bulidCandkestickChart(a,e,t);break;case"text":bulidTextTag(a,e)}}function getChartsData(a,e){var t=a.other||{},n=a.data;if(t.datatime&&0<t.datatime)setInterval(function(){1==t.dataFrom?e.call(this,globalData):2==t.dataFrom?$.ajax({url:"../getJSONDataByUrl",type:"post",data:{url:n.link},dataType:"json",async:!0,success:function(a){e.call(this,a)}}):3==t.dataFrom?$.ajax({type:"GET",url:n.link,dataType:"json",async:!0,success:function(a){e.call(this,a)}}):4==t.dataFrom&&$.ajax({type:"GET",url:n.link,async:!0,dataType:"json",success:function(a){e.call(this,a)}})},t.datatime);if(1==t.dataFrom)e.call(this,globalData);else if(2==t.dataFrom)$.ajax({url:"../getJSONDataByUrl",type:"post",data:{url:n.link},dataType:"json",async:!0,success:function(a){e.call(this,a)}});else if(4==t.dataFrom)$.ajax({type:"GET",url:n.link,async:!0,dataType:"json",success:function(a){e.call(this,a)}});else if(3==t.dataFrom)try{$.ajax({type:"GET",url:n.link,async:!0,dataType:"json",success:function(a){e.call(this,a)}})}catch(a){console.log(a)}else e.call(this)}function getFileName(a){var e=a.lastIndexOf("bddpConfig");return a.substring(e)}function bulidLineChart(s,r,e){var t=s.data;getChartsData(s,function(n){if(n){r.legend=r.legend||{},r.legend.data=r.legend.data||[],r.series=r.series||[];var a=getJsonValue(n,t.dimension[0].keyname);$.each(t.series,function(a,e){var t={data:getJsonValue(n,e.keyname),type:s.type,name:e.displayname};r.series[a]?r.series[a]=$.extend({},r.series[a],t):r.series.push(t),r.legend.data[a]?r.legend.data[a]=e.displayname:r.legend.data.push(e.displayname)}),r.xAxis.data=a,e.setOption(r)}})}function bulidBarChart(s,r,e){var t=s.data,i=s.other||{};getChartsData(s,function(n){if(n){r.legend=r.legend||{},r.legend.data=r.legend.data||[],r.series=r.series||[];var a=getJsonValue(n,t.dimension[0].keyname);$.each(t.series,function(a,e){var t={data:getJsonValue(n,e.keyname),type:s.type,name:e.displayname};r.series[a]?r.series[a]=$.extend({},r.series[a],t):r.series.push(t),r.legend.data[a]?r.legend.data[a]=e.displayname:r.legend.data.push(e.displayname)}),i.axis?r.yAxis.data=a:r.xAxis.data=a,e.setOption(r)}})}function bulidPieChart(l,d,o){var u=l.data;getChartsData(l,function(a){if(a){d.legend=d.legend||{},d.legend.data=d.legend.data||[],d.series=d.series||[];for(var e=getJsonValue(a,u.dimension[0].keyname),t=getJsonValue(a,u.series[0].keyname),n=[],s=0;s<e.length;s++){var r={name:e[s],value:t[s]};d.legend.data[s]?d.legend.data[s]=e[s]:d.legend.data.push(e[s]),n.push(r)}var i={data:n,type:l.type};d.series[0]?d.series[0]=$.extend({},d.series[0],i):d.series.push(i),o.setOption(d)}})}function bulidRadarChart(l,d,n){var o=l.data;getChartsData(l,function(a){if(a){d.legend=d.legend||{},d.legend.data=d.legend.data||[],d.series=d.series||[],d.radar=d.radar||{},d.radar.indicator=d.radar.indicator||[];var s=getJsonValue(a,o.dimension[0].keyname),e=getJsonValue(a,o.series[0].keyname),r={},i=0;$.each(e,function(a,e){var t={data:[],type:l.type},n={name:s[a],value:[]};d.legend.data[a]?d.legend.data[a]=s[a]:d.legend.data.push(s[a]),$.each(e,function(a,e){r[e.indicator]=e.value,i=i>e.value?i:e.value,n.value.push(e.value)}),t.data.push(n),d.series[a]?d.series[a]=$.extend({},d.series[a],t):d.series.push(t)});var t=0;$.each(r,function(a,e){d.radar.indicator[t]?d.radar.indicator[t]=$.extend({},d.radar.indicator[t],{name:a,max:i}):d.radar.indicator.push({name:a,max:i}),t++}),n.setOption(d)}})}function bulidTreeChart(n,s,r){var i=n.data;getChartsData(n,function(a){if(a){var e=getJsonValue(a,i.series[0].keyname);s.series=[];var t={data:[e],type:n.type};s.series.push(t),r.setOption(s)}})}function bulidTreemapChart(n,s,r){var i=n.data;getChartsData(n,function(a){if(a){var e=getJsonValue(a,i.series[0].keyname);s.series=[];var t={data:[e],type:n.type};s.series.push(t),r.setOption(s)}})}function bulidSunburstChart(n,s,r){var i=n.data;getChartsData(n,function(a){if(a){var e=getJsonValue(a,i.series[0].keyname);s.series=[];var t={data:[e],type:n.type};s.series.push(t),r.setOption(s)}})}function bulidFunnelChart(t,n,s){var r=t.data;getChartsData(t,function(a){if(a){var e=getJsonValue(a,r.series[0].keyname);$.each(e,function(a,e){e.type=t.type,n.series[a]=e}),s.setOption(n)}})}function bulidGaugeChart(n,s,t){var r=n.data,i=n.other;getChartsData(n,function(a){if(a){var e=getJsonValue(a,r.series[0].keyname);$.each(e,function(a,e){var t={};(t=4==i.dataFrom?{data:[{value:e}]}:e).type=n.type,s.series[a]?s.series[a]=$.extend({},s.series[a],t):s.series.push(t)}),t.setOption(s)}})}function bulidMapChart(a,r,e){var t=a.data;getChartsData(a,function(n){if(n){var s=0;$.each(t.dimension,function(a,e){var t=getJsonValue(n,e.keyname);r.series[s++].data=t}),$.each(t.series,function(a,e){var t=getJsonValue(n,e.keyname);r.series[s++].data=t}),e.setOption(r)}})}function bulidTextTag(t,n){var s=t.data;getChartsData(t,function(a){if(a&&s.dimension&&0<s.dimension.length){var e=getJsonValue(a,s.dimension[0].keyname);t.parts&&t.parts.format&&(e=t.parts.format.replace(/{val}/g,e)),$(n).html(e)}})}function getJsonValue(a,e){var t=e.split("."),n=a[t[0]];return"[object Array]"===Object.prototype.toString.apply(n)&&1<t.length?getJsonArray(n,0,t):"[object Object]"===Object.prototype.toString.apply(n)&&1<t.length?getJsonObject(n,0,t):n}function getJsonObject(a,e,t){if(e<t.length){var n=a[t[e+1]];return"[object Array]"===Object.prototype.toString.apply(n)&&e+1<t.length-1?getJsonArray(n,e+1,t):"[object Object]"===Object.prototype.toString.apply(n)&&e+1<t.length-1?getJsonObject(n,e+1,t):n}}function getJsonArray(a,n,s){var r=[];return $.each(a,function(a,e){if(n<s.length-1){var t=e[s[n+1]];"[object Array]"===Object.prototype.toString.apply(t)?r.push(getJsonArray(t,n+1,s)):"[object Object]"===Object.prototype.toString.apply(t)?r.push(getJsonObject(t,n+1,s)):r.push(t)}else r.push(e)}),r}