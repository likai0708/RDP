var tempDataReportLayerIndex;function setFrameId(e){var t=hot.Methods.getSelected();if(t){var o=t[0];hot.Methods.getCellMeta(o[0],o[1]);hot.Methods.setCellMeta(o[0],o[1],"frameid",$(e).val()),hot.Methods.setDataAtCell(o[0],o[1],"subreport:"+$(e).find("option:selected").text())}layer.close(tempDataReportLayerIndex)}function removeReport(){var e=hot.Methods.getSelected();if(e){var t=e[0],o=hot.Methods.getCellMeta(t[0],t[1]);o.frameid="",delete o.frameid,hot.Methods.setDataAtCell(t[0],t[1],"")}}function addSubReport(){var e=hot.Methods.getSelected();if(e){var t=e[0],o=hot.Methods.getCell(t[0],t[1]),a=$(o).offset().left+$(o).width(),d=$(o).offset().top+$(o).height(),l=hot.Methods.getCellMeta(t[0],t[1]).frameid;tempDataReportLayerIndex=layer.open({type:1,shade:.01,title:!1,shadeClose:!0,closeBtn:0,offset:[d+"px",a+"px"],resize:!1,success:function(e,t){e.find("#temlist").empty(),e.find("#temlist").append("<option value=''>请选择子报表</option>"),$.rdp.ajax({url:"../../rdp/selectAllReportFile?kw=",type:"post",success:function(e){var t=e.list;for(var o in t){var a="";l==t[o].uuid&&(a=" selected = 'selected'"),$("#temlist").append("<option value='"+t[o].uuid+"' "+a+">"+t[o].name+"</option>")}}})},content:$("#dataReports")})}}